
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Git to SVN migration - yield the dog</title>
  <meta name="author" content="yield the dog">

  
  <meta name="description" content="Starting point ----------IDEAS-----------
- migrate to what? DVCS for sure, but which? -&gt; git, bazar, mercurial =&gt; why git
- Statistics: How &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yieldthedog.github.com/blog/2012/01/19/git-to-svn-migration">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="yield the dog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-29924121-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <a href="/"><h1>yield the dog</h1></a>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:yieldthedog.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/categories/interesting-thingys/">Interesting Thingys</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content" class="
      
        
          git migration svn
        
      
      ">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Git to SVN Migration</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-19T07:09:00+01:00" pubdate data-updated="true">Jan 19<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Starting point</h2>

<pre><code>----------IDEAS-----------
- migrate to what? DVCS for sure, but which?
  -&gt; git, bazar, mercurial =&gt; why git
- Statistics: How many projects, users
- git knowledge of users
- OS mix: windows / mac / Linux
- user mix: command line geeks and gui freaks
----------IDEAS-----------
</code></pre>

<h2>Git server setup</h2>

<pre><code>----------IDEAS-----------
- setups we considered
  * gitosis
  * gitolite
  * gitorious
- how to configure and adapt gitorious
----------IDEAS-----------
</code></pre>

<h2>Migration process</h2>

<pre><code>----------IDEAS-----------
- not possible to do all at once, only incremental steps
- why it's easier to include the history
- what is possible to automate?
- branches, tags?
- different svn layouts (trunk, branches, tags vs multiple projects in one trunk)
- scripts we used
- svn:ignore -&gt; gitignore + github/gitignore
  * different setup for .NET, PHP, Ruby, HTML
----------IDEAS-----------
----------Missing---------
- downloadable shell scripts
----------Missing---------
</code></pre>

<p>Because our code base is that large, a migration over the
weekend was not possible. It had to be done in chunks. First
we needed a list of all repos and persons, who where
responsible for the repo. <code>svn ls --xml</code> was our friend,
which gave as an easy to transform output of all repos with
last committer names. That was good for a start.</p>

<p>It soon became apparent that we have some clients with lot
of projects and many clients with less than 5 projects. The
latter was no a problem, but the former had no good
structure and naming conventions in the Subversion
repository. We knew for sure that we did not want to migrate
and end up with the same mess as before. So way layed aside
all clients with lots of projects for discussion and
reorganization.</p>

<p>Next we defined, which projects should be migrated with
history and which not. This was a useless discussion,
because it was easier to always migrate with history, as you
will see later.</p>

<p>Our first steps were trying to migrate by hand:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git svn clone <span class="o">[</span>svn url<span class="o">]</span> <span class="o">[</span>repo name<span class="o">]</span>        <span class="c">#clone the svn repo to a git repo</span>
</span><span class='line'>git remote add gitorious <span class="o">[</span>gitorious url<span class="o">]</span>   <span class="c">#add a remote to the git server</span>
</span><span class='line'>git push gitorious master                  <span class="c">#push the repo to the server</span>
</span><span class='line'>
</span><span class='line'><span class="c"># done ... hurray ... no wait ....</span>
</span></code></pre></td></tr></table></div></figure>


<p>BIG FAIL</p>

<p>What had we missed?</p>

<ul>
<li>no users / usernames</li>
<li>no ignores</li>
<li>wrong file structure</li>
</ul>


<p>So lets fix this step by step.</p>

<h3>Users</h3>

<p>The users could be mapped rather easily from subversion to git in our case.
Subversion got the users first and last name and Git uses the uses email
address which in our case is the initial of the first name,
a dot, the last name @ our domain. Some times the Subversion
user had only a first name, but these were only rather old records, so they
could be easily ignored. We ended up writing a small Ruby script, that did the work</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#!/usr/bin/ruby</span>
</span><span class='line'><span class="nb">name</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="nb">name</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="nb">name</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot; &lt;&quot;</span><span class="o">+</span> <span class="nb">name</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">downcase</span> <span class="o">+</span> <span class="s2">&quot;@DOMAIN&gt;&quot;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="nb">name</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">name</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot; &lt;&quot;</span><span class="o">+</span> <span class="nb">name</span><span class="o">[</span><span class="mi">0</span><span class="o">][</span><span class="mi">0</span><span class="o">].</span><span class="n">chr</span><span class="o">.</span><span class="n">downcase</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span><span class="nb">name</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">downcase</span><span class="o">+</span><span class="s2">&quot;@DOMAIN&gt;&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we can call <code>git svn clone</code> with this authors.rb file like this:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git svn clone --authors-prog<span class="o">=</span>author.rb <span class="o">[</span>subversion url<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Ignores</h3>

<p>Next step is to define standard git ignores for projects and
to migrate the existing svn ignores over to git ignores. We
got a lot of help from the <a href="https://github.com/github/gitignore">Github gitignore
project</a>, which we
disected, combined, stripped,… until we had a default
gitignore file. With these two commands we added the
defaults and extracted the subversion ignores into a
gitignore file:</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># generate gitignore file</span>
</span><span class='line'>cat PATH_TO/default_gitignore.txt &gt; .gitignore
</span><span class='line'>git svn show-ignore &gt;&gt; .gitignore
</span><span class='line'>
</span><span class='line'><span class="c">#add it to the repository</span>
</span><span class='line'>git add .gitignore
</span><span class='line'>git commit -m<span class="s1">&#39;added gitignores&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Wrong file structure</h3>

<p>The last point was not to be easily resolved. Some SVN
Repositories had a standard layout (trunk, branches, tags),
others just had all code in the root folder without the
standard layout. In most cases we were not interested in
migrating branches and tags, because those were seldom used.
So it came down to having a trunk or not.</p>

<p>If there is a trunk present you can tell git to use this as
the root directory with <code>--trunk=trunk</code>.</p>

<h3>Wrapping things up</h3>

<p>Now that we had everything in place, we could start the
migration. Communication paths were installed via email and
a shared excel file, which tracked our progress. We created a shell script that automated most of the steps listed above. Still the migration had to be down partly manualy, which was tedious work.</p>

<h2>Migrate your users</h2>

<pre><code>----------IDEAS-----------
- gui tools needed
- small incremental steps
- playgrounds suck
----------IDEAS-----------
</code></pre>

<p>Parallel to the repositories migration we had to train our users on how to master the new tool chain. We knew that we had to provide both command line and gui tutorials, as most of our user base was used to TortoiseSVN. We knew that Git was fundamentally different to SVN, but to our users it was just another VCS. The knowledge base of the users was quite different, so we had to be careful to not leave anybody behind and to not bore others on the other hand.</p>

<p>What we came up with were three training sessions:
- Introduction to Git and it&#8217;s environment
- Branching and Merging
- Git Workflows</p>

<h2>Conclusion</h2>

<pre><code>----------IDEAS-----------
- same same but different or was it worth the effort?
- are things better or worse?
- what is missing now?
- external collaboration
- Stats
  7 Jahre
  14 GB Daten
  83 User
  86 Projekte
  405 Repositories
  30103 Commits
  586756 Files
  Viele viele LOCs
----------IDEAS-----------
</code></pre>

<p>After everything was done, we had a little time to
contemplate and dig for some statistics. We migrated 7 years
of versioned code, 14 GB of data, 83 Users, 86 projects with
a total of 86 repositories.  30103 Commits were moved to
Git, 586756 files, and many many lines of code.</p>

<h2>Was it worth the effort?</h2>

<p>Hopefully time will prove us right. Surely we get some good feedback, but especially for non technical people the learning curve is a bit steep:</p>

<blockquote><ul>
<li>Did you push your changes?</li>
<li>Sure. I pressed the commit button.</li>
</ul>
</blockquote>

<p>On the other hand people were using feature branches from day one, the started exploring advanced features by them selfs. Of course they sometimes f***ed up. Who cares? Shit happens everyday and there are less unresolvable problems with Git, than there were with SVN.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">yield the dog</span></span>

      








  


<time datetime="2012-01-19T07:09:00+01:00" pubdate data-updated="true">Jan 19<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/git/'>git</a>, <a class='category' href='/blog/categories/migration/'>migration</a>, <a class='category' href='/blog/categories/svn/'>svn</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://yieldthedog.github.com/blog/2012/01/19/git-to-svn-migration/" data-via="" data-counturl="http://yieldthedog.github.com/blog/2012/01/19/git-to-svn-migration/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/01/17/interesting-thingys-1/" title="Previous Post: Interesting Thingys #1">&laquo; Interesting Thingys #1</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/01/23/interesting-thingys-2/" title="next Post: Interesting Thingys #2">Interesting Thingys #2 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/25/interesting-thingys-52/">Interesting Thingys 52</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/19/interesting-thingys-51/">Interesting Thingys 51</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/12/interesting-thingys-50/">Interesting Thingys 50</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/05/interesting-thingys-49/">Interesting Thingys 49</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/28/interesting-thingys-48/">Interesting Thingys 48</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - yield the dog -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> |
  This blog is not affiliated with <a href="http://diamonddogs.cc">the diamond:dogs group</a>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'yieldthedog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://yieldthedog.github.com/blog/2012/01/19/git-to-svn-migration/';
        var disqus_url = 'http://yieldthedog.github.com/blog/2012/01/19/git-to-svn-migration/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
